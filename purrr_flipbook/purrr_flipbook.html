<!DOCTYPE html>
<html>
  <head>
    <title>purrr flipbook</title>
    <meta charset="utf-8">
    <meta name="author" content="  Gina Reynolds, April 2019" />
    <link href="libs/remark-css-0.0.1/kunoichi.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/ninjutsu.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# purrr flipbook
## data structures and functional programming with purrr | made with Xaringan
### <br><br>Gina Reynolds, April 2019
### <br>

---





# Introduction

What about purrr.  The R package purrr feels hard to me, but it does have so much promise of providing a easy tidy, efficient workflow.  Maybe purrr feels hard to you too. I need some practice in it and maybe my practice could be a useful reference for you!  Let's flipbook it! 

I recommend you starting with less complicated data structures that can be managed only with dplyr and tidyr, which are both also part of the tidyverse.  If you aren't familiar with these tools you might want to start there and practice those tools: [The Tidyverse in Action]( https://evamaerey.github.io/tidyverse_in_action/tidyverse_in_action.html#1)



---
# What is purrr

I'm not really sure, so quoting from purrr.tidyverse.org:

&gt; purrr enhances R’s functional programming (FP) toolkit by providing a complete and consistent set of tools for working with functions and vectors. If you’ve never heard of FP before, the best place to start is the family of map() functions which allow you to replace many for loops with code that is both more succinct and easier to read. The best place to learn about the map() functions is the iteration chapter in R for data science.




---

# Getting started with R and RStudio

The tools demonstrated in this book are implemented in the statistical software, R which is opensource and freely available.  RStudio, an integrated development environment (IDE), is a nice environment for working in R.  The following links may help you get R and RStudio up and running. 

- [Install Windows](https://www.youtube.com/watch?v=aCRMhAWmtpw)
- [Install Mac](https://www.youtube.com/watch?v=GLLZhc_5enQ)


---

# Acknowledgements

I'm grateful to the tidyverse team for their tireless work on developing and maintaining this wonderful toolkit and to RStudio for supporting the development.  Emi Tanaka (@statsgen) and Garrick Aden-Buie (@grrrck) helped by writing code to made the flipbook style possible. I'm *very* grateful to them for their work on this as well as to Yihui Xie and others for their work on the Xaringan package --- the extraordinary platform for creating the slides for this book.  I'm thankful too to my students who refresh my perspective on teaching and learning new tools.  Finally, thanks to my family and friends who support data wrangling, plotting, modeling, and me. 



---

# Load the tidyverse and data

To get started, you'll need to install the packages "tidyverse" and load data.  Execute this code in your console:


```r
install.packages("tidyverse")
install.packages("gapminder")
```

Then, in an R script or .Rmd you can use and execute the following code: 


```r
options(scipen = 10) # adjust when scientific notation turns on
library(tidyverse)
```


---
# Data structures



class: split-50
count: false

.column[.content[

```r
*c(1, 4, 2, 6) # c() is the "concatinate" function
```
]]
.column[.content.center[

```
  [1] 1 4 2 6
```
]]
---
class: split-50
count: false

.column[.content[

```r
c(1, 4, 2, 6) -&gt; # c() is the "concatinate" function
* my_vector # Now we've done the assignment
```
]]
.column[.content.center[

]]
---
class: split-50
count: false

.column[.content[

```r
c(1, 4, 2, 6) -&gt; # c() is the "concatinate" function
  my_vector # Now we've done the assignment
 #&lt;&lt;
```
]]
.column[.content.center[

]]
---
class: split-50
count: false

.column[.content[

```r
c(1, 4, 2, 6) -&gt; # c() is the "concatinate" function
  my_vector # Now we've done the assignment

*my_vector[3]
```
]]
.column[.content.center[

```
  [1] 2
```
]]

---




class: split-50
count: false

.column[.content[

```r
*c(1, 4, 2, 6) # c() is the "concatinate" function
```
]]
.column[.content.center[

```
  [1] 1 4 2 6
```
]]
---
class: split-50
count: false

.column[.content[

```r
c(1, 4, 2, 6) -&gt; # c() is the "concatinate" function
* my_vector # Now we've done the assignment
```
]]
.column[.content.center[

]]
---
class: split-50
count: false

.column[.content[

```r
c(1, 4, 2, 6) -&gt; # c() is the "concatinate" function
  my_vector # Now we've done the assignment
 #&lt;&lt;
```
]]
.column[.content.center[

]]
---
class: split-50
count: false

.column[.content[

```r
c(1, 4, 2, 6) -&gt; # c() is the "concatinate" function
  my_vector # Now we've done the assignment

*my_vector[3]
```
]]
.column[.content.center[

```
  [1] 2
```
]]

---

# Matrix



class: split-50
count: false

.column[.content[

```r
*matrix(1:15, nrow = 3)
```
]]
.column[.content.center[

```
       [,1] [,2] [,3] [,4] [,5]
  [1,]    1    4    7   10   13
  [2,]    2    5    8   11   14
  [3,]    3    6    9   12   15
```
]]

---

# Simple lists


```r
list("apple", 1:5) -&gt;
  a_list_i_made

a_list_i_made[[1]] # access elements with double brackets
```

```
  [1] "apple"
```

---

# Simple Named lists


```r
list(thing_1 = "a", thing_2 = matrix(data = 1:5, nrow = 2)) -&gt;
  my_named_list
```

```
  Warning in matrix(data = 1:5, nrow = 2): data length [5] is not a sub-
  multiple or multiple of the number of rows [2]
```

```r
my_named_list$thing_1 # access via dollarsign
```

```
  [1] "a"
```

---

# Lists containing lists (complex lists)


```r
list("a", 1:5, my_named_list) -&gt;
  lists_containing_lists
lists_containing_lists[[3]]$thing_2 # accessing parts of a complex list
```

```
       [,1] [,2] [,3]
  [1,]    1    3    5
  [2,]    2    4    1
```


---
# 


```r
list( c("mac", "granny"), 
      c("naval", "blood"))[2]
```

```
  [[1]]
  [1] "naval" "blood"
```


```r
list(apples = c("mac", "granny"), 
     oranges = c("naval", "blood"))$oranges
```

```
  [1] "naval" "blood"
```


---
# From purrr cheatsheet


&gt; List column workflow

- Make a list column
- Work with list column
- Simplify the list column







```r
# linear modeling function
mod_fun &lt;- function(df) lm(Sepal.Length ~ ., data = df) 
# returnes coefficients of the model? 
b_fun &lt;- function(mod) coefficients(mod)[[1]]
```







---

class: split-50
count: false

.column[.content[

```r
*iris
```
]]
.column[.content.center[

```
      Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
  1            5.1         3.5          1.4         0.2     setosa
  2            4.9         3.0          1.4         0.2     setosa
  3            4.7         3.2          1.3         0.2     setosa
  4            4.6         3.1          1.5         0.2     setosa
  5            5.0         3.6          1.4         0.2     setosa
  6            5.4         3.9          1.7         0.4     setosa
  7            4.6         3.4          1.4         0.3     setosa
  8            5.0         3.4          1.5         0.2     setosa
  9            4.4         2.9          1.4         0.2     setosa
  10           4.9         3.1          1.5         0.1     setosa
  11           5.4         3.7          1.5         0.2     setosa
  12           4.8         3.4          1.6         0.2     setosa
  13           4.8         3.0          1.4         0.1     setosa
  14           4.3         3.0          1.1         0.1     setosa
  15           5.8         4.0          1.2         0.2     setosa
  16           5.7         4.4          1.5         0.4     setosa
  17           5.4         3.9          1.3         0.4     setosa
  18           5.1         3.5          1.4         0.3     setosa
  19           5.7         3.8          1.7         0.3     setosa
  20           5.1         3.8          1.5         0.3     setosa
  21           5.4         3.4          1.7         0.2     setosa
  22           5.1         3.7          1.5         0.4     setosa
  23           4.6         3.6          1.0         0.2     setosa
  24           5.1         3.3          1.7         0.5     setosa
  25           4.8         3.4          1.9         0.2     setosa
  26           5.0         3.0          1.6         0.2     setosa
  27           5.0         3.4          1.6         0.4     setosa
  28           5.2         3.5          1.5         0.2     setosa
  29           5.2         3.4          1.4         0.2     setosa
  30           4.7         3.2          1.6         0.2     setosa
  31           4.8         3.1          1.6         0.2     setosa
  32           5.4         3.4          1.5         0.4     setosa
  33           5.2         4.1          1.5         0.1     setosa
  34           5.5         4.2          1.4         0.2     setosa
  35           4.9         3.1          1.5         0.2     setosa
  36           5.0         3.2          1.2         0.2     setosa
  37           5.5         3.5          1.3         0.2     setosa
  38           4.9         3.6          1.4         0.1     setosa
  39           4.4         3.0          1.3         0.2     setosa
  40           5.1         3.4          1.5         0.2     setosa
  41           5.0         3.5          1.3         0.3     setosa
  42           4.5         2.3          1.3         0.3     setosa
  43           4.4         3.2          1.3         0.2     setosa
  44           5.0         3.5          1.6         0.6     setosa
  45           5.1         3.8          1.9         0.4     setosa
  46           4.8         3.0          1.4         0.3     setosa
  47           5.1         3.8          1.6         0.2     setosa
  48           4.6         3.2          1.4         0.2     setosa
  49           5.3         3.7          1.5         0.2     setosa
  50           5.0         3.3          1.4         0.2     setosa
  51           7.0         3.2          4.7         1.4 versicolor
  52           6.4         3.2          4.5         1.5 versicolor
  53           6.9         3.1          4.9         1.5 versicolor
  54           5.5         2.3          4.0         1.3 versicolor
  55           6.5         2.8          4.6         1.5 versicolor
  56           5.7         2.8          4.5         1.3 versicolor
  57           6.3         3.3          4.7         1.6 versicolor
  58           4.9         2.4          3.3         1.0 versicolor
  59           6.6         2.9          4.6         1.3 versicolor
  60           5.2         2.7          3.9         1.4 versicolor
  61           5.0         2.0          3.5         1.0 versicolor
  62           5.9         3.0          4.2         1.5 versicolor
  63           6.0         2.2          4.0         1.0 versicolor
  64           6.1         2.9          4.7         1.4 versicolor
  65           5.6         2.9          3.6         1.3 versicolor
  66           6.7         3.1          4.4         1.4 versicolor
  67           5.6         3.0          4.5         1.5 versicolor
  68           5.8         2.7          4.1         1.0 versicolor
  69           6.2         2.2          4.5         1.5 versicolor
  70           5.6         2.5          3.9         1.1 versicolor
  71           5.9         3.2          4.8         1.8 versicolor
  72           6.1         2.8          4.0         1.3 versicolor
  73           6.3         2.5          4.9         1.5 versicolor
  74           6.1         2.8          4.7         1.2 versicolor
  75           6.4         2.9          4.3         1.3 versicolor
  76           6.6         3.0          4.4         1.4 versicolor
  77           6.8         2.8          4.8         1.4 versicolor
  78           6.7         3.0          5.0         1.7 versicolor
  79           6.0         2.9          4.5         1.5 versicolor
  80           5.7         2.6          3.5         1.0 versicolor
  81           5.5         2.4          3.8         1.1 versicolor
  82           5.5         2.4          3.7         1.0 versicolor
  83           5.8         2.7          3.9         1.2 versicolor
  84           6.0         2.7          5.1         1.6 versicolor
  85           5.4         3.0          4.5         1.5 versicolor
  86           6.0         3.4          4.5         1.6 versicolor
  87           6.7         3.1          4.7         1.5 versicolor
  88           6.3         2.3          4.4         1.3 versicolor
  89           5.6         3.0          4.1         1.3 versicolor
  90           5.5         2.5          4.0         1.3 versicolor
  91           5.5         2.6          4.4         1.2 versicolor
  92           6.1         3.0          4.6         1.4 versicolor
  93           5.8         2.6          4.0         1.2 versicolor
  94           5.0         2.3          3.3         1.0 versicolor
  95           5.6         2.7          4.2         1.3 versicolor
  96           5.7         3.0          4.2         1.2 versicolor
  97           5.7         2.9          4.2         1.3 versicolor
  98           6.2         2.9          4.3         1.3 versicolor
  99           5.1         2.5          3.0         1.1 versicolor
  100          5.7         2.8          4.1         1.3 versicolor
  101          6.3         3.3          6.0         2.5  virginica
  102          5.8         2.7          5.1         1.9  virginica
  103          7.1         3.0          5.9         2.1  virginica
  104          6.3         2.9          5.6         1.8  virginica
  105          6.5         3.0          5.8         2.2  virginica
  106          7.6         3.0          6.6         2.1  virginica
  107          4.9         2.5          4.5         1.7  virginica
  108          7.3         2.9          6.3         1.8  virginica
  109          6.7         2.5          5.8         1.8  virginica
  110          7.2         3.6          6.1         2.5  virginica
  111          6.5         3.2          5.1         2.0  virginica
  112          6.4         2.7          5.3         1.9  virginica
  113          6.8         3.0          5.5         2.1  virginica
  114          5.7         2.5          5.0         2.0  virginica
  115          5.8         2.8          5.1         2.4  virginica
  116          6.4         3.2          5.3         2.3  virginica
  117          6.5         3.0          5.5         1.8  virginica
  118          7.7         3.8          6.7         2.2  virginica
  119          7.7         2.6          6.9         2.3  virginica
  120          6.0         2.2          5.0         1.5  virginica
  121          6.9         3.2          5.7         2.3  virginica
  122          5.6         2.8          4.9         2.0  virginica
  123          7.7         2.8          6.7         2.0  virginica
  124          6.3         2.7          4.9         1.8  virginica
  125          6.7         3.3          5.7         2.1  virginica
  126          7.2         3.2          6.0         1.8  virginica
  127          6.2         2.8          4.8         1.8  virginica
  128          6.1         3.0          4.9         1.8  virginica
  129          6.4         2.8          5.6         2.1  virginica
  130          7.2         3.0          5.8         1.6  virginica
  131          7.4         2.8          6.1         1.9  virginica
  132          7.9         3.8          6.4         2.0  virginica
  133          6.4         2.8          5.6         2.2  virginica
  134          6.3         2.8          5.1         1.5  virginica
  135          6.1         2.6          5.6         1.4  virginica
  136          7.7         3.0          6.1         2.3  virginica
  137          6.3         3.4          5.6         2.4  virginica
  138          6.4         3.1          5.5         1.8  virginica
  139          6.0         3.0          4.8         1.8  virginica
  140          6.9         3.1          5.4         2.1  virginica
  141          6.7         3.1          5.6         2.4  virginica
  142          6.9         3.1          5.1         2.3  virginica
  143          5.8         2.7          5.1         1.9  virginica
  144          6.8         3.2          5.9         2.3  virginica
  145          6.7         3.3          5.7         2.5  virginica
  146          6.7         3.0          5.2         2.3  virginica
  147          6.3         2.5          5.0         1.9  virginica
  148          6.5         3.0          5.2         2.0  virginica
  149          6.2         3.4          5.4         2.3  virginica
  150          5.9         3.0          5.1         1.8  virginica
```
]]
---
class: split-50
count: false

.column[.content[

```r
iris %&gt;% 
* group_by(Species)
```
]]
.column[.content.center[

```
  # A tibble: 150 x 5
  # Groups:   Species [3]
     Sepal.Length Sepal.Width Petal.Length Petal.Width Species
            &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
   1          5.1         3.5          1.4         0.2 setosa 
   2          4.9         3            1.4         0.2 setosa 
   3          4.7         3.2          1.3         0.2 setosa 
   4          4.6         3.1          1.5         0.2 setosa 
   5          5           3.6          1.4         0.2 setosa 
   6          5.4         3.9          1.7         0.4 setosa 
   7          4.6         3.4          1.4         0.3 setosa 
   8          5           3.4          1.5         0.2 setosa 
   9          4.4         2.9          1.4         0.2 setosa 
  10          4.9         3.1          1.5         0.1 setosa 
  # … with 140 more rows
```
]]
---
class: split-50
count: false

.column[.content[

```r
iris %&gt;% 
  group_by(Species) %&gt;% 
* nest() # Make a list column
```
]]
.column[.content.center[

```
  # A tibble: 3 x 2
    Species    data             
    &lt;fct&gt;      &lt;list&gt;           
  1 setosa     &lt;tibble [50 × 4]&gt;
  2 versicolor &lt;tibble [50 × 4]&gt;
  3 virginica  &lt;tibble [50 × 4]&gt;
```
]]
---
class: split-50
count: false

.column[.content[

```r
iris %&gt;% 
  group_by(Species) %&gt;% 
  nest() %&gt;% # Make a list column
* mutate(model = map(data, mod_fun)) # lm(Sepal.Length ~ ., data = df)
```
]]
.column[.content.center[

```
  # A tibble: 3 x 3
    Species    data              model   
    &lt;fct&gt;      &lt;list&gt;            &lt;list&gt;  
  1 setosa     &lt;tibble [50 × 4]&gt; &lt;S3: lm&gt;
  2 versicolor &lt;tibble [50 × 4]&gt; &lt;S3: lm&gt;
  3 virginica  &lt;tibble [50 × 4]&gt; &lt;S3: lm&gt;
```
]]
---
class: split-50
count: false

.column[.content[

```r
iris %&gt;% 
  group_by(Species) %&gt;% 
  nest() %&gt;% # Make a list column
  mutate(model = map(data, mod_fun)) %&gt;% # lm(Sepal.Length ~ ., data = df) 
* mutate(beta_0 = map_dbl(model, b_fun)) # coefficients(mod)[[1]]
```
]]
.column[.content.center[

```
  # A tibble: 3 x 4
    Species    data              model    beta_0
    &lt;fct&gt;      &lt;list&gt;            &lt;list&gt;    &lt;dbl&gt;
  1 setosa     &lt;tibble [50 × 4]&gt; &lt;S3: lm&gt;  2.35 
  2 versicolor &lt;tibble [50 × 4]&gt; &lt;S3: lm&gt;  1.90 
  3 virginica  &lt;tibble [50 × 4]&gt; &lt;S3: lm&gt;  0.700
```
]]
---
class: split-50
count: false

.column[.content[

```r
iris %&gt;% 
  group_by(Species) %&gt;% 
  nest() %&gt;% # Make a list column
  mutate(model = map(data, mod_fun)) %&gt;% # lm(Sepal.Length ~ ., data = df) 
  mutate(beta_0 = map_dbl(model, b_fun)) -&gt; # coefficients(mod)[[1]]
*iris_mods
```
]]
.column[.content.center[

]]


---

# Looking inside a list-column


```r
iris_mods$model 
```

```
  [[1]]
  
  Call:
  lm(formula = Sepal.Length ~ ., data = df)
  
  Coefficients:
   (Intercept)   Sepal.Width  Petal.Length   Petal.Width  
        2.3519        0.6548        0.2376        0.2521  
  
  
  [[2]]
  
  Call:
  lm(formula = Sepal.Length ~ ., data = df)
  
  Coefficients:
   (Intercept)   Sepal.Width  Petal.Length   Petal.Width  
        1.8955        0.3869        0.9083       -0.6792  
  
  
  [[3]]
  
  Call:
  lm(formula = Sepal.Length ~ ., data = df)
  
  Coefficients:
   (Intercept)   Sepal.Width  Petal.Length   Petal.Width  
        0.6999        0.3303        0.9455       -0.1698
```

---

# Looking at an element in a list-column



```r
iris_mods$data[[3]]
```

```
  # A tibble: 50 x 4
     Sepal.Length Sepal.Width Petal.Length Petal.Width
            &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
   1          6.3         3.3          6           2.5
   2          5.8         2.7          5.1         1.9
   3          7.1         3            5.9         2.1
   4          6.3         2.9          5.6         1.8
   5          6.5         3            5.8         2.2
   6          7.6         3            6.6         2.1
   7          4.9         2.5          4.5         1.7
   8          7.3         2.9          6.3         1.8
   9          6.7         2.5          5.8         1.8
  10          7.2         3.6          6.1         2.5
  # … with 40 more rows
```


---
# Greater detail and examples

&gt; MAKE A LIST COLUMN - You can create list columns with functions in the tibble and dplyr packages, as well as tidyr’s nest()

---

&gt; tibble::tribble(...)
Makes list column when needed



```r
tribble( ~max, ~seq, 
         3, 1:3,
         4, 1:4, 
         5, 1:5)
```

```
  # A tibble: 3 x 2
      max seq      
    &lt;dbl&gt; &lt;list&gt;   
  1     3 &lt;int [3]&gt;
  2     4 &lt;int [4]&gt;
  3     5 &lt;int [5]&gt;
```
---

&gt; tibble::tibble(...)
Saves list input as list columns


```r
tibble(max = c(3, 4, 5), 
       seq = list(1:3, 1:4, 1:5))
```

```
  # A tibble: 3 x 2
      max seq      
    &lt;dbl&gt; &lt;list&gt;   
  1     3 &lt;int [3]&gt;
  2     4 &lt;int [4]&gt;
  3     5 &lt;int [5]&gt;
```

---

&gt; tibble::enframe(x, name="name", value="value") Converts multi-level list to tibble with list cols



```r
enframe(list('3' = 1:3, '4' = 1:4, '5' = 1:5), 
        'max', 'seq')
```

```
  # A tibble: 3 x 2
    max   seq      
    &lt;chr&gt; &lt;list&gt;   
  1 3     &lt;int [3]&gt;
  2 4     &lt;int [4]&gt;
  3 5     &lt;int [5]&gt;
```

---

dplyr::mutate(.data, ...) Also transmute() Returns list col when result returns list.


```r
mtcars %&gt;% 
  mutate(seq = map(cyl, seq))
```

```
      mpg cyl  disp  hp drat    wt  qsec vs am gear carb
  1  21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
  2  21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
  3  22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
  4  21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
  5  18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
  6  18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
  7  14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
  8  24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
  9  22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
  10 19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
  11 17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
  12 16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
  13 17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
  14 15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
  15 10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
  16 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
  17 14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
  18 32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
  19 30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
  20 33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
  21 21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
  22 15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
  23 15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
  24 13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
  25 19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
  26 27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
  27 26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
  28 30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
  29 15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
  30 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
  31 15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
  32 21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2
                        seq
  1        1, 2, 3, 4, 5, 6
  2        1, 2, 3, 4, 5, 6
  3              1, 2, 3, 4
  4        1, 2, 3, 4, 5, 6
  5  1, 2, 3, 4, 5, 6, 7, 8
  6        1, 2, 3, 4, 5, 6
  7  1, 2, 3, 4, 5, 6, 7, 8
  8              1, 2, 3, 4
  9              1, 2, 3, 4
  10       1, 2, 3, 4, 5, 6
  11       1, 2, 3, 4, 5, 6
  12 1, 2, 3, 4, 5, 6, 7, 8
  13 1, 2, 3, 4, 5, 6, 7, 8
  14 1, 2, 3, 4, 5, 6, 7, 8
  15 1, 2, 3, 4, 5, 6, 7, 8
  16 1, 2, 3, 4, 5, 6, 7, 8
  17 1, 2, 3, 4, 5, 6, 7, 8
  18             1, 2, 3, 4
  19             1, 2, 3, 4
  20             1, 2, 3, 4
  21             1, 2, 3, 4
  22 1, 2, 3, 4, 5, 6, 7, 8
  23 1, 2, 3, 4, 5, 6, 7, 8
  24 1, 2, 3, 4, 5, 6, 7, 8
  25 1, 2, 3, 4, 5, 6, 7, 8
  26             1, 2, 3, 4
  27             1, 2, 3, 4
  28             1, 2, 3, 4
  29 1, 2, 3, 4, 5, 6, 7, 8
  30       1, 2, 3, 4, 5, 6
  31 1, 2, 3, 4, 5, 6, 7, 8
  32             1, 2, 3, 4
```


---

dplyr::summarise(.data, ...)
Returns list col when result is wrapped with list()


```r
mtcars %&gt;% 
  group_by(cyl) %&gt;% 
  summarise(q = list(quantile(mpg)))
```

```
  # A tibble: 3 x 2
      cyl q        
    &lt;dbl&gt; &lt;list&gt;   
  1     4 &lt;dbl [5]&gt;
  2     6 &lt;dbl [5]&gt;
  3     8 &lt;dbl [5]&gt;
```


---
## 2 WORK WITH LIST COLUMNS - Use the purrr functions map(), map2(), and pmap() to apply a function that returns a result element-wise to the cells of a list column. walk(), walk2(), and pwalk() work the same way, but return a side effect.

---

# set up

```r
n_iris &lt;- iris %&gt;% 
  group_by(Species) %&gt;% 
  nest()
mod_fun &lt;- function(df) lm(Sepal.Length ~ ., data = df)
m_iris &lt;- n_iris %&gt;%
  mutate(model = map(data, mod_fun))
```





---


purrr::map(.x, .f, ...)
Apply .f element-wise to .x as .f(.x) 



class: split-50
count: false

.column[.content[

```r
*n_iris
```
]]
.column[.content.center[

```
  # A tibble: 3 x 2
    Species    data             
    &lt;fct&gt;      &lt;list&gt;           
  1 setosa     &lt;tibble [50 × 4]&gt;
  2 versicolor &lt;tibble [50 × 4]&gt;
  3 virginica  &lt;tibble [50 × 4]&gt;
```
]]
---
class: split-50
count: false

.column[.content[

```r
n_iris %&gt;% 
* mutate(n = map(data, dim))
```
]]
.column[.content.center[

```
  # A tibble: 3 x 3
    Species    data              n        
    &lt;fct&gt;      &lt;list&gt;            &lt;list&gt;   
  1 setosa     &lt;tibble [50 × 4]&gt; &lt;int [2]&gt;
  2 versicolor &lt;tibble [50 × 4]&gt; &lt;int [2]&gt;
  3 virginica  &lt;tibble [50 × 4]&gt; &lt;int [2]&gt;
```
]]

---

purrr::map2(.x, .y, .f, ...)
Apply .f element-wise to .x and .y as .f(.x, .y) 



class: split-50
count: false

.column[.content[

```r
*m_iris
```
]]
.column[.content.center[

```
  # A tibble: 3 x 3
    Species    data              model   
    &lt;fct&gt;      &lt;list&gt;            &lt;list&gt;  
  1 setosa     &lt;tibble [50 × 4]&gt; &lt;S3: lm&gt;
  2 versicolor &lt;tibble [50 × 4]&gt; &lt;S3: lm&gt;
  3 virginica  &lt;tibble [50 × 4]&gt; &lt;S3: lm&gt;
```
]]
---
class: split-50
count: false

.column[.content[

```r
m_iris %&gt;% 
* mutate(n = map2(data, model, list))
```
]]
.column[.content.center[

```
  # A tibble: 3 x 4
    Species    data              model    n         
    &lt;fct&gt;      &lt;list&gt;            &lt;list&gt;   &lt;list&gt;    
  1 setosa     &lt;tibble [50 × 4]&gt; &lt;S3: lm&gt; &lt;list [2]&gt;
  2 versicolor &lt;tibble [50 × 4]&gt; &lt;S3: lm&gt; &lt;list [2]&gt;
  3 virginica  &lt;tibble [50 × 4]&gt; &lt;S3: lm&gt; &lt;list [2]&gt;
```
]]


---


purrr::pmap(.l, .f, ...)
Apply .f element-wise to vectors saved in .l 



class: split-50
count: false

.column[.content[

```r
*m_iris
```
]]
.column[.content.center[

```
  # A tibble: 3 x 3
    Species    data              model   
    &lt;fct&gt;      &lt;list&gt;            &lt;list&gt;  
  1 setosa     &lt;tibble [50 × 4]&gt; &lt;S3: lm&gt;
  2 versicolor &lt;tibble [50 × 4]&gt; &lt;S3: lm&gt;
  3 virginica  &lt;tibble [50 × 4]&gt; &lt;S3: lm&gt;
```
]]
---
class: split-50
count: false

.column[.content[

```r
m_iris %&gt;%
* mutate(n = pmap(list(data, model, data), list))
```
]]
.column[.content.center[

```
  # A tibble: 3 x 4
    Species    data              model    n         
    &lt;fct&gt;      &lt;list&gt;            &lt;list&gt;   &lt;list&gt;    
  1 setosa     &lt;tibble [50 × 4]&gt; &lt;S3: lm&gt; &lt;list [3]&gt;
  2 versicolor &lt;tibble [50 × 4]&gt; &lt;S3: lm&gt; &lt;list [3]&gt;
  3 virginica  &lt;tibble [50 × 4]&gt; &lt;S3: lm&gt; &lt;list [3]&gt;
```
]]


---


3. SIMPLIFY THE LIST COLUMN (into a regular column)

Use the purrr functions map_lgl(), map_int(), map_dbl(), map_chr(), as well as tidyr’s unnest() to reduce a list column into a regular column.

---

purrr::map_lgl(.x, .f, ...)
Apply .f element-wise to .x, return a logical vector 



class: split-50
count: false

.column[.content[

```r
*n_iris
```
]]
.column[.content.center[

```
  # A tibble: 3 x 2
    Species    data             
    &lt;fct&gt;      &lt;list&gt;           
  1 setosa     &lt;tibble [50 × 4]&gt;
  2 versicolor &lt;tibble [50 × 4]&gt;
  3 virginica  &lt;tibble [50 × 4]&gt;
```
]]
---
class: split-50
count: false

.column[.content[

```r
n_iris %&gt;% 
* transmute(n = map_lgl(data, is.matrix))
```
]]
.column[.content.center[

```
  # A tibble: 3 x 1
    n    
    &lt;lgl&gt;
  1 FALSE
  2 FALSE
  3 FALSE
```
]]


---

purrr::map_int(.x, .f, ...)
Apply .f element-wise to .x, return an integer vector 



class: split-50
count: false

.column[.content[

```r
*n_iris
```
]]
.column[.content.center[

```
  # A tibble: 3 x 2
    Species    data             
    &lt;fct&gt;      &lt;list&gt;           
  1 setosa     &lt;tibble [50 × 4]&gt;
  2 versicolor &lt;tibble [50 × 4]&gt;
  3 virginica  &lt;tibble [50 × 4]&gt;
```
]]
---
class: split-50
count: false

.column[.content[

```r
n_iris %&gt;% 
* transmute(n = map_int(data, nrow))
```
]]
.column[.content.center[

```
  # A tibble: 3 x 1
        n
    &lt;int&gt;
  1    50
  2    50
  3    50
```
]]


---

purrr::map_dbl(.x, .f, ...)
Apply .f element-wise to .x, return a double vector



class: split-50
count: false

.column[.content[

```r
*n_iris
```
]]
.column[.content.center[

```
  # A tibble: 3 x 2
    Species    data             
    &lt;fct&gt;      &lt;list&gt;           
  1 setosa     &lt;tibble [50 × 4]&gt;
  2 versicolor &lt;tibble [50 × 4]&gt;
  3 virginica  &lt;tibble [50 × 4]&gt;
```
]]
---
class: split-50
count: false

.column[.content[

```r
n_iris %&gt;% 
* transmute(n = map_dbl(data, nrow))
```
]]
.column[.content.center[

```
  # A tibble: 3 x 1
        n
    &lt;dbl&gt;
  1    50
  2    50
  3    50
```
]]


---



purrr::map_chr(.x, .f, ...)
Apply .f element-wise to .x, return a character vector 




class: split-50
count: false

.column[.content[

```r
*n_iris
```
]]
.column[.content.center[

```
  # A tibble: 3 x 2
    Species    data             
    &lt;fct&gt;      &lt;list&gt;           
  1 setosa     &lt;tibble [50 × 4]&gt;
  2 versicolor &lt;tibble [50 × 4]&gt;
  3 virginica  &lt;tibble [50 × 4]&gt;
```
]]
---
class: split-50
count: false

.column[.content[

```r
n_iris %&gt;% 
* transmute(n = map_chr(data, nrow))
```
]]
.column[.content.center[

```
  # A tibble: 3 x 1
    n    
    &lt;chr&gt;
  1 50   
  2 50   
  3 50
```
]]


---




```r
mtcars %&gt;% 
  select(mpg, cyl) %&gt;% 
  distinct() %&gt;% 
  mutate(seq = map(cyl, seq)) %&gt;% 
  unnest()
```

```
       mpg cyl seq
  1   21.0   6   1
  2   21.0   6   2
  3   21.0   6   3
  4   21.0   6   4
  5   21.0   6   5
  6   21.0   6   6
  7   22.8   4   1
  8   22.8   4   2
  9   22.8   4   3
  10  22.8   4   4
  11  21.4   6   1
  12  21.4   6   2
  13  21.4   6   3
  14  21.4   6   4
  15  21.4   6   5
  16  21.4   6   6
  17  18.7   8   1
  18  18.7   8   2
  19  18.7   8   3
  20  18.7   8   4
  21  18.7   8   5
  22  18.7   8   6
  23  18.7   8   7
  24  18.7   8   8
  25  18.1   6   1
  26  18.1   6   2
  27  18.1   6   3
  28  18.1   6   4
  29  18.1   6   5
  30  18.1   6   6
  31  14.3   8   1
  32  14.3   8   2
  33  14.3   8   3
  34  14.3   8   4
  35  14.3   8   5
  36  14.3   8   6
  37  14.3   8   7
  38  14.3   8   8
  39  24.4   4   1
  40  24.4   4   2
  41  24.4   4   3
  42  24.4   4   4
  43  19.2   6   1
  44  19.2   6   2
  45  19.2   6   3
  46  19.2   6   4
  47  19.2   6   5
  48  19.2   6   6
  49  17.8   6   1
  50  17.8   6   2
  51  17.8   6   3
  52  17.8   6   4
  53  17.8   6   5
  54  17.8   6   6
  55  16.4   8   1
  56  16.4   8   2
  57  16.4   8   3
  58  16.4   8   4
  59  16.4   8   5
  60  16.4   8   6
  61  16.4   8   7
  62  16.4   8   8
  63  17.3   8   1
  64  17.3   8   2
  65  17.3   8   3
  66  17.3   8   4
  67  17.3   8   5
  68  17.3   8   6
  69  17.3   8   7
  70  17.3   8   8
  71  15.2   8   1
  72  15.2   8   2
  73  15.2   8   3
  74  15.2   8   4
  75  15.2   8   5
  76  15.2   8   6
  77  15.2   8   7
  78  15.2   8   8
  79  10.4   8   1
  80  10.4   8   2
  81  10.4   8   3
  82  10.4   8   4
  83  10.4   8   5
  84  10.4   8   6
  85  10.4   8   7
  86  10.4   8   8
  87  14.7   8   1
  88  14.7   8   2
  89  14.7   8   3
  90  14.7   8   4
  91  14.7   8   5
  92  14.7   8   6
  93  14.7   8   7
  94  14.7   8   8
  95  32.4   4   1
  96  32.4   4   2
  97  32.4   4   3
  98  32.4   4   4
  99  30.4   4   1
  100 30.4   4   2
  101 30.4   4   3
  102 30.4   4   4
  103 33.9   4   1
  104 33.9   4   2
  105 33.9   4   3
  106 33.9   4   4
  107 21.5   4   1
  108 21.5   4   2
  109 21.5   4   3
  110 21.5   4   4
  111 15.5   8   1
  112 15.5   8   2
  113 15.5   8   3
  114 15.5   8   4
  115 15.5   8   5
  116 15.5   8   6
  117 15.5   8   7
  118 15.5   8   8
  119 13.3   8   1
  120 13.3   8   2
  121 13.3   8   3
  122 13.3   8   4
  123 13.3   8   5
  124 13.3   8   6
  125 13.3   8   7
  126 13.3   8   8
  127 19.2   8   1
  128 19.2   8   2
  129 19.2   8   3
  130 19.2   8   4
  131 19.2   8   5
  132 19.2   8   6
  133 19.2   8   7
  134 19.2   8   8
  135 27.3   4   1
  136 27.3   4   2
  137 27.3   4   3
  138 27.3   4   4
  139 26.0   4   1
  140 26.0   4   2
  141 26.0   4   3
  142 26.0   4   4
  143 15.8   8   1
  144 15.8   8   2
  145 15.8   8   3
  146 15.8   8   4
  147 15.8   8   5
  148 15.8   8   6
  149 15.8   8   7
  150 15.8   8   8
  151 19.7   6   1
  152 19.7   6   2
  153 19.7   6   3
  154 19.7   6   4
  155 19.7   6   5
  156 19.7   6   6
  157 15.0   8   1
  158 15.0   8   2
  159 15.0   8   3
  160 15.0   8   4
  161 15.0   8   5
  162 15.0   8   6
  163 15.0   8   7
  164 15.0   8   8
  165 21.4   4   1
  166 21.4   4   2
  167 21.4   4   3
  168 21.4   4   4
```


```r
mtcars %&gt;% 
  group_by(cyl) %&gt;% 
  summarise(quantiles = list(quantile(mpg))) %&gt;% 
  unnest()
```

```
  # A tibble: 15 x 2
       cyl quantiles
     &lt;dbl&gt;     &lt;dbl&gt;
   1     4      21.4
   2     4      22.8
   3     4      26  
   4     4      30.4
   5     4      33.9
   6     6      17.8
   7     6      18.6
   8     6      19.7
   9     6      21  
  10     6      21.4
  11     8      10.4
  12     8      14.4
  13     8      15.2
  14     8      16.2
  15     8      19.2
```






```r
iris %&gt;%
  group_by(Species) %&gt;%
  nest() %&gt;% 
  mutate(dimensions = map(data, dim)) %&gt;% 
  mutate(rows = dimensions[[1]][1]) %&gt;% 
  mutate(columns = dimensions[[1]][2]) %&gt;% 
  select(-data) %&gt;% 
  unnest()
```

```
  # A tibble: 6 x 4
    Species     rows columns dimensions
    &lt;fct&gt;      &lt;int&gt;   &lt;int&gt;      &lt;int&gt;
  1 setosa        50       4         50
  2 setosa        50       4          4
  3 versicolor    50       4         50
  4 versicolor    50       4          4
  5 virginica     50       4         50
  6 virginica     50       4          4
```

---
# List Column


```r
iris %&gt;% 
  group_by(Species) %&gt;% 
  nest() %&gt;%
  mutate(model = map(data, mod_fun))  %&gt;% 
  mutate(n = map2(data, model, list)) -&gt;
iris_more_mod

iris_more_mod$n
```

```
  [[1]]
  [[1]][[1]]
  # A tibble: 50 x 4
     Sepal.Length Sepal.Width Petal.Length Petal.Width
            &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
   1          5.1         3.5          1.4         0.2
   2          4.9         3            1.4         0.2
   3          4.7         3.2          1.3         0.2
   4          4.6         3.1          1.5         0.2
   5          5           3.6          1.4         0.2
   6          5.4         3.9          1.7         0.4
   7          4.6         3.4          1.4         0.3
   8          5           3.4          1.5         0.2
   9          4.4         2.9          1.4         0.2
  10          4.9         3.1          1.5         0.1
  # … with 40 more rows
  
  [[1]][[2]]
  
  Call:
  lm(formula = Sepal.Length ~ ., data = df)
  
  Coefficients:
   (Intercept)   Sepal.Width  Petal.Length   Petal.Width  
        2.3519        0.6548        0.2376        0.2521  
  
  
  
  [[2]]
  [[2]][[1]]
  # A tibble: 50 x 4
     Sepal.Length Sepal.Width Petal.Length Petal.Width
            &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
   1          7           3.2          4.7         1.4
   2          6.4         3.2          4.5         1.5
   3          6.9         3.1          4.9         1.5
   4          5.5         2.3          4           1.3
   5          6.5         2.8          4.6         1.5
   6          5.7         2.8          4.5         1.3
   7          6.3         3.3          4.7         1.6
   8          4.9         2.4          3.3         1  
   9          6.6         2.9          4.6         1.3
  10          5.2         2.7          3.9         1.4
  # … with 40 more rows
  
  [[2]][[2]]
  
  Call:
  lm(formula = Sepal.Length ~ ., data = df)
  
  Coefficients:
   (Intercept)   Sepal.Width  Petal.Length   Petal.Width  
        1.8955        0.3869        0.9083       -0.6792  
  
  
  
  [[3]]
  [[3]][[1]]
  # A tibble: 50 x 4
     Sepal.Length Sepal.Width Petal.Length Petal.Width
            &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
   1          6.3         3.3          6           2.5
   2          5.8         2.7          5.1         1.9
   3          7.1         3            5.9         2.1
   4          6.3         2.9          5.6         1.8
   5          6.5         3            5.8         2.2
   6          7.6         3            6.6         2.1
   7          4.9         2.5          4.5         1.7
   8          7.3         2.9          6.3         1.8
   9          6.7         2.5          5.8         1.8
  10          7.2         3.6          6.1         2.5
  # … with 40 more rows
  
  [[3]][[2]]
  
  Call:
  lm(formula = Sepal.Length ~ ., data = df)
  
  Coefficients:
   (Intercept)   Sepal.Width  Petal.Length   Petal.Width  
        0.6999        0.3303        0.9455       -0.1698
```

```r
iris %&gt;% 
  group_by(Species) %&gt;% 
  nest() %&gt;%
  mutate(model = map(data, mod_fun)) %&gt;%
  mutate(n = pmap(list(data, model, data), list)) -&gt;
more_manipulations

more_manipulations$n
```

```
  [[1]]
  [[1]][[1]]
  # A tibble: 50 x 4
     Sepal.Length Sepal.Width Petal.Length Petal.Width
            &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
   1          5.1         3.5          1.4         0.2
   2          4.9         3            1.4         0.2
   3          4.7         3.2          1.3         0.2
   4          4.6         3.1          1.5         0.2
   5          5           3.6          1.4         0.2
   6          5.4         3.9          1.7         0.4
   7          4.6         3.4          1.4         0.3
   8          5           3.4          1.5         0.2
   9          4.4         2.9          1.4         0.2
  10          4.9         3.1          1.5         0.1
  # … with 40 more rows
  
  [[1]][[2]]
  
  Call:
  lm(formula = Sepal.Length ~ ., data = df)
  
  Coefficients:
   (Intercept)   Sepal.Width  Petal.Length   Petal.Width  
        2.3519        0.6548        0.2376        0.2521  
  
  
  [[1]][[3]]
  # A tibble: 50 x 4
     Sepal.Length Sepal.Width Petal.Length Petal.Width
            &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
   1          5.1         3.5          1.4         0.2
   2          4.9         3            1.4         0.2
   3          4.7         3.2          1.3         0.2
   4          4.6         3.1          1.5         0.2
   5          5           3.6          1.4         0.2
   6          5.4         3.9          1.7         0.4
   7          4.6         3.4          1.4         0.3
   8          5           3.4          1.5         0.2
   9          4.4         2.9          1.4         0.2
  10          4.9         3.1          1.5         0.1
  # … with 40 more rows
  
  
  [[2]]
  [[2]][[1]]
  # A tibble: 50 x 4
     Sepal.Length Sepal.Width Petal.Length Petal.Width
            &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
   1          7           3.2          4.7         1.4
   2          6.4         3.2          4.5         1.5
   3          6.9         3.1          4.9         1.5
   4          5.5         2.3          4           1.3
   5          6.5         2.8          4.6         1.5
   6          5.7         2.8          4.5         1.3
   7          6.3         3.3          4.7         1.6
   8          4.9         2.4          3.3         1  
   9          6.6         2.9          4.6         1.3
  10          5.2         2.7          3.9         1.4
  # … with 40 more rows
  
  [[2]][[2]]
  
  Call:
  lm(formula = Sepal.Length ~ ., data = df)
  
  Coefficients:
   (Intercept)   Sepal.Width  Petal.Length   Petal.Width  
        1.8955        0.3869        0.9083       -0.6792  
  
  
  [[2]][[3]]
  # A tibble: 50 x 4
     Sepal.Length Sepal.Width Petal.Length Petal.Width
            &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
   1          7           3.2          4.7         1.4
   2          6.4         3.2          4.5         1.5
   3          6.9         3.1          4.9         1.5
   4          5.5         2.3          4           1.3
   5          6.5         2.8          4.6         1.5
   6          5.7         2.8          4.5         1.3
   7          6.3         3.3          4.7         1.6
   8          4.9         2.4          3.3         1  
   9          6.6         2.9          4.6         1.3
  10          5.2         2.7          3.9         1.4
  # … with 40 more rows
  
  
  [[3]]
  [[3]][[1]]
  # A tibble: 50 x 4
     Sepal.Length Sepal.Width Petal.Length Petal.Width
            &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
   1          6.3         3.3          6           2.5
   2          5.8         2.7          5.1         1.9
   3          7.1         3            5.9         2.1
   4          6.3         2.9          5.6         1.8
   5          6.5         3            5.8         2.2
   6          7.6         3            6.6         2.1
   7          4.9         2.5          4.5         1.7
   8          7.3         2.9          6.3         1.8
   9          6.7         2.5          5.8         1.8
  10          7.2         3.6          6.1         2.5
  # … with 40 more rows
  
  [[3]][[2]]
  
  Call:
  lm(formula = Sepal.Length ~ ., data = df)
  
  Coefficients:
   (Intercept)   Sepal.Width  Petal.Length   Petal.Width  
        0.6999        0.3303        0.9455       -0.1698  
  
  
  [[3]][[3]]
  # A tibble: 50 x 4
     Sepal.Length Sepal.Width Petal.Length Petal.Width
            &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
   1          6.3         3.3          6           2.5
   2          5.8         2.7          5.1         1.9
   3          7.1         3            5.9         2.1
   4          6.3         2.9          5.6         1.8
   5          6.5         3            5.8         2.2
   6          7.6         3            6.6         2.1
   7          4.9         2.5          4.5         1.7
   8          7.3         2.9          6.3         1.8
   9          6.7         2.5          5.8         1.8
  10          7.2         3.6          6.1         2.5
  # … with 40 more rows
```











&lt;style type="text/css"&gt;
.remark-code{line-height: 1.5; font-size: 60%}
&lt;/style&gt;
    </textarea>
<script src="libs/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightLines": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
